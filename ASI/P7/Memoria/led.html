<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <link href='http://fonts.googleapis.com/css?family=Monofett' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
    <link rel="stylesheet"type="text/css"href="estil.css">
    <title>Led ESTAT</title>
<script>
      window.onload = function load()
      {
      var xmlhttp;
      var objecte_div;
      objecte_div=document.getElementById("img");
      xmlhttp=new XMLHttpRequest();
      xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
      {
      if (xmlhttp.responseText=="Off")
      {
      
      objecte_div.src = "ledoff.png";
      console.log("Off")
      }
      if (xmlhttp.responseText=="On")
      {
      console.log("On")
      objecte_div.src="ledon.png";
      }
      }
      }
      xmlhttp.open("GET","/led",true);
      xmlhttp.send();
      }
	  function loadXMLDoc()
      {
      var xmlhttp;
      var objecte_div;
      objecte_div=document.getElementById("img");
      xmlhttp=new XMLHttpRequest();
      xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
      {
      if (xmlhttp.responseText=="Off")
      {
      
      objecte_div.src = "ledoff.png";
      console.log("Off")
      }
      if (xmlhttp.responseText=="On")
      {
      console.log("On")
      objecte_div.src="ledon.png";
      }
      }
      }
      xmlhttp.open("GET","/led",true);
      xmlhttp.send();
      }
      function on()
      {
      var xmlhttp;
      var objecte_div;
      objecte_div=document.getElementById("img");
      xmlhttp=new XMLHttpRequest();
      xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
      {
      if (xmlhttp.responseText=="On")
      {
      objecte_div.src="ledon.png";
      console.log("Ences el led")
      }
      }
      }
      xmlhttp.open("GET","/led_on",true);
      xmlhttp.send();
      }

      function off()
      {
      var xmlhttp;
      var objecte_div;
      objecte_div=document.getElementById("img");
      xmlhttp=new XMLHttpRequest();
      xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
      {
      if (xmlhttp.responseText=="Off")
      {
      objecte_div.src="ledoff.png";
      console.log("Apagat el led")
      }
      }
      }
      xmlhttp.open("GET","/led_off",true);
      xmlhttp.send();
      } 
    </script>
  </head>
  <body>
    <a href="http://web.g2.asi.itic.cat"><img class="foto3" src="inici.png" alt="Inici" title="Inici"></a>
    <div id="top1">
      <h1>CONTROL LED</h1>
    </div>
    <br>
    <table>
      <tr>
	
	<td colspan="2">
		<div id="myDiv">
			<img src="unknown.png" id="img" alt="ledon" width="100" height="100" align="center"><br></td>
		</div>
      </tr>
      <tr>
	<td><div id="juon"><button onclick="on()">ON</button></div>
	</td>
	<td><div id="juoff"><button onclick="off()">OFF</button></div>
	</td>
      </tr>
    </table>
    <script>
      <!--Cada 3 segons, crida la funcio loadXMLDoc()-->
      setInterval("loadXMLDoc()",3000);
    </script>
  </body>
</html>
